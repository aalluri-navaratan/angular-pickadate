!function(e){"use strict";function t(t,a){var n=[];return e.forEach(t,function(t){n.push(e.isFunction(a)?a(t):t[a])}),n}var a=[].indexOf||function(e){for(var t=0,a=this.length;a>t;t++)if(t in this&&this[t]===e)return t;return-1};e.module("pickadate",[]).provider("pickadateI18n",function(){var e={prev:"prev",next:"next"};this.translations={},this.$get=function(){var t=this.translations;return{t:function(a){return t[a]||e[a]}}}}).factory("pickadateModalBindings",["$window","$document",function(e,t){var n=void 0!==e.pageXOffset,i="CSS1Compat"===(t.compatMode||""),r=function(a){var r=n?e.pageXOffset:i?t.documentElement.scrollLeft:t.body.scrollLeft,d=n?e.pageYOffset:i?t.documentElement.scrollTop:t.body.scrollTop,o=e.innerWidth||t.documentElement.clientWidth||t.body.clientWidth,s={top:d+a.getBoundingClientRect().bottom+"px"};return o-a.getBoundingClientRect().left>=300?s.left=r+a.getBoundingClientRect().left+"px":s.right=o-a.getBoundingClientRect().right-r+"px",s},d=function(e,t){for(var a=t.parentNode;null!==a;){if(a===e)return!0;a=a.parentNode}return!1};return function(e,n,i){var o=function(t){e.displayPicker=t,e.$apply()};n.on("focus",function(){e.modalStyles=r(n[0]),o(!0)}),n.on("keydown",function(e){a.call([9,13,27],e.keyCode)>=0&&o(!1)}),t.on("click",function(e){d(i,e.target)||e.target===n[0]||o(!1)})}}]).factory("pickadateDateHelper",["$locale","dateFilter",function(t,n){function i(e){switch(e){case"dd":return"day";case"MM":return"month";case"yyyy":return"year"}}return function(r,d){var o,s,c,l,u,f;return d=d||{},r=r||"yyyy-MM-dd",u=d.weekStartsOn,f=d.noExtraRows,(!e.isNumber(u)||0>u||u>6)&&(u=0),{parseDate:function(t){if(t){if(e.isDate(t))return new Date(t);var a="(dd|MM|yyyy)",n=r.match(/[-|/]/)[0],d=t.split(n),o=new RegExp([a,a,a].join(n)),s=r.match(o),c={};if(s.shift(),e.forEach(s,function(e,t){c[i(e)]=parseInt(d[t],10)}),!(isNaN(c.year)||isNaN(c.month)||isNaN(c.day)))return new Date(c.year,c.month-1,c.day,3)}},setRestrictions:function(e,t,a,n){o=this.parseDate(e.minDate)||new Date(0),s=this.parseDate(e.maxDate)||new Date(99999999999999),l=e.currentDate,c=e.disabledDates||[],t&&(a&&"endDate"===e.rangeEditMode?o=new Date(a.date):e.endDate&&(s=new Date(e.endDate.date)))},allowPrevMonth:function(){return l>o},allowNextMonth:function(){var t=e.copy(l);return t.setMonth(t.getMonth()+1),s>=t},buildDateObject:function(t){var i=e.copy(t),u=n(i,r),f=a.call(c,u)>=0,p=this.getMonthOffset(i,l),D=o>i,h=i>s,y=-1===p&&!d.previousMonthSelectable||1===p&&!d.nextMonthSelectable;return{date:i,formattedDate:u,today:u===n(new Date,r),disabled:f,outOfMinRange:D,outOfMaxRange:h,monthOffset:p,enabled:!(f||D||h||y)}},buildDates:function(t,a,n){var i=[],r=new Date(t,a,1,3),d=new Date(t,a+1,0,3);for(n=n||{},l=e.copy(r);r.getDay()!==u;)r.setDate(r.getDate()-1);for(var o=0;42>o&&!(f&&r.getDay()===u&&r>d);o++)i.push(this.buildDateObject(r)),r.setDate(r.getDate()+1);return i},buildDayNames:function(){var e=t.DATETIME_FORMATS.SHORTDAY;if(u){e=e.slice(0);for(var a=0;u>a;a++)e.push(e.shift())}return e},getMonthOffset:function(e,t){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())}}}}]).directive("pickadate",["$locale","$sce","$compile","$document","$window","pickadateDateHelper","pickadateI18n","pickadateModalBindings","filterFilter",function(n,i,r,d,o,s,c,l,u){var f='<div class="pickadate" ng-show="displayPicker" ng-style="modalStyles"><div class="pickadate__header"><a href="" class="pickadate__previous" ng-click="changeMonth(-1)" ng-show="allowPrevMonth"></a><div class="pickadate__title" ng-bind="currentDate | date:\'MMMM yyyy\'"></div><a href="" class="pickadate__next" ng-click="changeMonth(1)" ng-show="allowNextMonth"></a></div><div class="pickadate__body"><div class="pickadate__main"><div class="pickadate__row"><div class="pickadate__day pickadate__day--day-name" ng-repeat="dayName in dayNames">{{dayName}}</div></div><div class="pickadate__row"><div class="pickadate__day" ng-repeat="dateObj in dates" ng-click="setDate(dateObj)" ng-class="classesFor(dateObj)" ng-bind="dateObj.date | date:\'d\'"></div></div></div></div></div>';return{require:"ngModel",scope:{defaultDate:"=",minDate:"=",maxDate:"=",disabledDates:"=",weekStartsOn:"=",rangeEditMode:"=",endDate:"="},link:function(n,i,d,o){function c(){var e=b.buildDates(n.currentDate.getFullYear(),n.currentDate.getMonth());n.allowPrevMonth=b.allowPrevMonth(),n.allowNextMonth=b.allowNextMonth(),n.dayNames=b.buildDayNames(),n.dates=t(e,function(e){return e.classNames=[e.enabled?"is-enabled":"is-disabled"],e.today&&e.classNames.push("pickadate__day--today"),e.disabled&&e.classNames.push("is-unavailable"),e})}function p(e,a){a=a||{},h?o.$setViewValue(t(e,"formattedDate")):o.$setViewValue(e[0]&&e[0].formattedDate),a.skipRenderInput||i.val(o.$viewValue)}function D(e,t){var n=a.call(t,e);return-1===n?t.push(e):t.splice(n,1),t}var h=d.hasOwnProperty("multiple"),y=d.hasOwnProperty("range"),v=[],g=null,m=null,M=i[0]instanceof HTMLInputElement,w=r(f)(n),k=(d.format||"yyyy-MM-dd").replace(/m/g,"M"),b=s(k,{previousMonthSelectable:/^(previous|both)$/.test(d.selectOtherMonths),nextMonthSelectable:/^(next|both)$/.test(d.selectOtherMonths),weekStartsOn:n.weekStartsOn,noExtraRows:d.hasOwnProperty("noExtraRows")});n.displayPicker=!M,n.setDate=function(e){e.enabled&&(y?"endDate"===n.rangeEditMode?n.setEndDate(e):(n.setStartDate(e),m||(n.rangeEditMode="endDate")):(v=h?D(e,v):[e],p(v),n.displayPicker=!M))},n.setStartDate=function(e){v=[e.date],g=e,p(g)},n.setEndDate=function(e){n.endDate=e,m=e,p(m)};var _=o.$render=function(a){null===o.$modelValue&&(g=null,n.rangeEditMode="startDate"),e.isArray(o.$viewValue)?v=o.$viewValue:o.$viewValue&&(v=[o.$viewValue]),v[0].formattedDate&&(v[0]=v[0].formattedDate),m&&null==n.endDate&&(m=n.endDate,n.rangeEditMode="startDate"),n.currentDate=b.parseDate(n.defaultDate||v[0])||new Date,b.setRestrictions(n,y,g),v=t(v,function(e){return b.buildDateObject(b.parseDate(e))}),v=u(v,{enabled:!0}),p(v,a),c()};n.classesFor=function(e){var n=[];if(y)g&&e.formattedDate===g.formattedDate&&n.push("pickadate__day--start-date"),m&&e.formattedDate===m.formattedDate&&n.push("pickadate__day--end-date"),g&&m&&e.date>g.date&&e.date<m.date&&n.push("pickadate__day--in-range");else var i=t(v,"formattedDate"),n=a.call(i,e.formattedDate)>=0?"pickadate-active":null;return e.classNames.concat(n)},n.changeMonth=function(e){e&&(n.currentDate.setDate(1),n.currentDate.setMonth(n.currentDate.getMonth()+e),c())},n.$watch(function(){return e.toJson([n.minDate,n.maxDate,n.disabledDates,n.rangeEditMode,n.endDate])},_),M?(l(n,i,w[0]),n.$watch(function(){return o.$viewValue},function(e){var t=b.parseDate(e);t&&_({skipRenderInput:!0}),o.$setValidity("date",!!t)}),n.$$postDigest(function(){d.value&&(o.$viewValue=d.value,_())}),i.after(w.addClass("pickadate-modal"))):i.append(w)}}}])}(window.angular);